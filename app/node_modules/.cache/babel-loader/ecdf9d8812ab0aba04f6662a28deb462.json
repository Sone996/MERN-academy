{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useContext } from \"react\";\nimport { useMutation } from \"react-query\";\nimport { AppContext } from \"../../Context/AppProvider\";\nimport { useHistory } from \"react-router-dom\";\nimport { ActionTypes } from \"../../Context/Reducers/App/AppProvider.types\";\nimport { authService } from \"../../Modules/AuthModule/Auth.service\";\nimport { notificationMsg } from \"../../Services/BaseService\";\nimport { errorMsg, successMsg } from \"../../Services/MessageDisplayHandler\";\nexport function LoginHook() {\n  _s();\n\n  // eslint-disable-next-line\n  const [contextState, dispatch] = useContext(AppContext);\n  const history = useHistory();\n  return useMutation(val => authService.login(val), {\n    onMutate: () => {\n      dispatch({\n        type: ActionTypes.SET_LOADER,\n        payload: true\n      });\n    },\n    onError: err => {\n      errorMsg(notificationMsg(err, null));\n    },\n    onSettled: response => {\n      dispatch({\n        type: ActionTypes.SET_LOADER,\n        payload: false\n      });\n      dispatch({\n        type: ActionTypes.SET_USER,\n        payload: response.data\n      });\n      successMsg(notificationMsg(response, \"lOGIN_SUCCESS\"));\n\n      if (response.data.role === \"teacher\") {\n        history.push(\"/teacher-home\");\n      } else {\n        history.push(\"/student-home\");\n      }\n    }\n  });\n}\n\n_s(LoginHook, \"WFgIioVJ4GOMm5IpB7Vz+MgtKpw=\", false, function () {\n  return [useHistory, useMutation];\n});\n\n_c = LoginHook;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginHook\");","map":{"version":3,"names":["useContext","useMutation","AppContext","useHistory","ActionTypes","authService","notificationMsg","errorMsg","successMsg","LoginHook","contextState","dispatch","history","val","login","onMutate","type","SET_LOADER","payload","onError","err","onSettled","response","SET_USER","data","role","push"],"sources":["/Users/nebojsa/projects/MERN-academy/factory-academy-react-query-ts/src/Components/CustomHooks/LoginHook.ts"],"sourcesContent":["import { useContext } from \"react\";\nimport { useMutation } from \"react-query\";\nimport { AppContext } from \"../../Context/AppProvider\";\nimport { useHistory } from \"react-router-dom\";\nimport { ActionTypes } from \"../../Context/Reducers/App/AppProvider.types\";\nimport { authService } from \"../../Modules/AuthModule/Auth.service\";\nimport { notificationMsg } from \"../../Services/BaseService\";\nimport { errorMsg, successMsg } from \"../../Services/MessageDisplayHandler\";\n\nexport function LoginHook() {\n  // eslint-disable-next-line\n  const [contextState, dispatch] = useContext(AppContext);\n  const history = useHistory();\n\n  return useMutation((val: any) => authService.login(val), {\n    onMutate: () => {\n      dispatch({\n        type: ActionTypes.SET_LOADER,\n        payload: true,\n      });\n    },\n    onError: (err: any) => {\n      errorMsg(notificationMsg(err, null));\n    },\n    onSettled: (response: any) => {\n      dispatch({\n        type: ActionTypes.SET_LOADER,\n        payload: false,\n      });\n      dispatch({\n        type: ActionTypes.SET_USER,\n        payload: response.data,\n      });\n      successMsg(notificationMsg(response, \"lOGIN_SUCCESS\"));\n      if (response.data.role === \"teacher\") {\n        history.push(\"/teacher-home\");\n      } else {\n        history.push(\"/student-home\");\n      }\n    },\n  });\n}\n"],"mappings":";;AAAA,SAASA,UAAT,QAA2B,OAA3B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,UAAT,QAA2B,2BAA3B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,WAAT,QAA4B,8CAA5B;AACA,SAASC,WAAT,QAA4B,uCAA5B;AACA,SAASC,eAAT,QAAgC,4BAAhC;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,sCAArC;AAEA,OAAO,SAASC,SAAT,GAAqB;EAAA;;EAC1B;EACA,MAAM,CAACC,YAAD,EAAeC,QAAf,IAA2BX,UAAU,CAACE,UAAD,CAA3C;EACA,MAAMU,OAAO,GAAGT,UAAU,EAA1B;EAEA,OAAOF,WAAW,CAAEY,GAAD,IAAcR,WAAW,CAACS,KAAZ,CAAkBD,GAAlB,CAAf,EAAuC;IACvDE,QAAQ,EAAE,MAAM;MACdJ,QAAQ,CAAC;QACPK,IAAI,EAAEZ,WAAW,CAACa,UADX;QAEPC,OAAO,EAAE;MAFF,CAAD,CAAR;IAID,CANsD;IAOvDC,OAAO,EAAGC,GAAD,IAAc;MACrBb,QAAQ,CAACD,eAAe,CAACc,GAAD,EAAM,IAAN,CAAhB,CAAR;IACD,CATsD;IAUvDC,SAAS,EAAGC,QAAD,IAAmB;MAC5BX,QAAQ,CAAC;QACPK,IAAI,EAAEZ,WAAW,CAACa,UADX;QAEPC,OAAO,EAAE;MAFF,CAAD,CAAR;MAIAP,QAAQ,CAAC;QACPK,IAAI,EAAEZ,WAAW,CAACmB,QADX;QAEPL,OAAO,EAAEI,QAAQ,CAACE;MAFX,CAAD,CAAR;MAIAhB,UAAU,CAACF,eAAe,CAACgB,QAAD,EAAW,eAAX,CAAhB,CAAV;;MACA,IAAIA,QAAQ,CAACE,IAAT,CAAcC,IAAd,KAAuB,SAA3B,EAAsC;QACpCb,OAAO,CAACc,IAAR,CAAa,eAAb;MACD,CAFD,MAEO;QACLd,OAAO,CAACc,IAAR,CAAa,eAAb;MACD;IACF;EAzBsD,CAAvC,CAAlB;AA2BD;;GAhCejB,S;UAGEN,U,EAETF,W;;;KALOQ,S"},"metadata":{},"sourceType":"module"}